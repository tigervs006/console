(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[245],{40245:function(Ve,je,t){"use strict";t.d(je,{b:function(){return dt}});var We=t(13062),de=t(71230),Be=t(89032),ee=t(15746),G=t(21010),Ae=t(14781),Fe=t(23492),oe=t(20228),ye=t(11382),Pe=t(62999),Ze=t(95216),Oe=t(54029),he=t(79166),we=t(57663),te=t(71577),q=t(49111),Y=t(19650),Ee=t(71194),Re=t(97022),ut=t(34792),ae=t(48086),Ce=t(3182),g=t(11849),H=t(2824),pt=t(402),Ue=t(95574),Qe=t(94043),re=t.n(Qe),Se=t(75860),Te=t(59886),be=t(21940),me=t(22369),vt=t(43185),Me=t(9053),ht=t(74379),De=t(38648),mt=t(66126),ke=t(7789),C=t(67294),Ge=t(36571),Le=t(1870),$e=t(7085),ze=t(62298),e=t(85893),He=function(a){var A,U,$,S,N,W,I,z,K,j,Z,_,ce=Re.Z.confirm,Q=(A=a==null?void 0:a.crop)!==null&&A!==void 0?A:0,T=(U=a==null?void 0:a.size)!==null&&U!==void 0?U:0,X=($=a==null?void 0:a.maxUpload)!==null&&$!==void 0?$:0,P=(S=a==null?void 0:a.cropQuality)!==null&&S!==void 0?S:.6,u=(N=a==null?void 0:a.formTitle)!==null&&N!==void 0?N:"\u4E0A\u4F20\u56FE\u50CF",x=(W=a==null?void 0:a.listType)!==null&&W!==void 0?W:"text",F=(0,C.useState)(!1),d=(0,H.Z)(F,2),s=d[0],m=d[1],y=Q?!1:(I=a==null?void 0:a.multiple)!==null&&I!==void 0?I:!0,h=a!=null&&a.astricts?a.astricts[0]:0,M=a!=null&&a.astricts?a.astricts[1]:0,B=(z=a==null?void 0:a.uploadUrl)!==null&&z!==void 0?z:"/console/attach/upload",le=(0,G.tT)("file",function(b){return{uploadList:b.uploadList,setUploadList:b.setUploadList}}),ue=le.uploadList,L=le.setUploadList,fe=a!=null&&a.aspects?a.aspects[0]/a.aspects[1]:1,pe=a==null||(K=a.fileExt)===null||K===void 0?void 0:K.map(function(b){return".".concat(b)}).join(","),V=(j=a==null?void 0:a.fileMime)!==null&&j!==void 0?j:["video/mp4","image/png","image/gif","image/jpeg","audio/mpeg","image/x-icon","application/vnd.ms-works","application/vnd.ms-excel","image/vnd.microsoft.icon","application/octet-stream","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],xe=function(D){return new Promise(function(O,l){var n,o,r=(n=D==null?void 0:D.url)!==null&&n!==void 0?n:"",c;1<r.indexOf(".cn/")&&(c=r.substring(r.indexOf(".cn/")+4)),ce({centered:!0,cancelText:"\u7B97\u4E86",title:"\u5F53\u771F\u8981\u5220\u9664?",icon:(0,e.jsx)(Le.Z,{"data-inspector-line":"90","data-inspector-column":"22","data-inspector-relative-path":"src\\pages\\components\\UploadAdapter\\index.tsx"}),cancelButtonProps:{shape:"round"},okButtonProps:{danger:!0,shape:"round"},content:(o=r.match(/\/(\w+\.(?:png|jpg|gif|bmp))$/i))===null||o===void 0?void 0:o[1],onOk:function(){var w;(0,Ge.Yd)({filePath:(w=c)!==null&&w!==void 0?w:r}).then(function(i){i!=null&&i.success?O(!0):l("error")})},onCancel:function(){l("onCancel")}})})},ge=function(D){var O,l,n=D.file,o=D.fileList;L(o.slice());var r=D.file.status;switch(r){case"uploading":m(!0),ae.default.info("File ".concat(n.name," is uploading..."));break;case"success":ae.default.success("File ".concat(n.name," uploaded successfully"));break;case"removed":L(o),ae.default.success("File ".concat(n.name," removed successfully"));break;case"error":De.default.error({message:"Error",description:(O=n==null||(l=n.response)===null||l===void 0?void 0:l.msg)!==null&&O!==void 0?O:"File ".concat(n.name," upload failed")});break;case"done":a.fetch(),m(!1);var c=n.response.msg,v=n.response.success;L(function(w){var i;return w.concat([(0,g.Z)((0,g.Z)({},n==null||(i=n.response)===null||i===void 0?void 0:i.data),{},{status:"done"})]).filter(function(p){return!(p!=null&&p.response)})}),v?ae.default.success("File ".concat(n.name," ").concat(c)):(L([]),ae.default.error("File ".concat(n.name," ").concat(c)));break;case void 0:m(!1),L([]);break;default:throw new Error("Not implemented yet: undefined case")}},J=function(D){var O=1024*1024,l=D.type;return new Promise(function(n,o){if(!V.includes(l))De.default.error({message:"\u6587\u4EF6\u7C7B\u578B\u9519\u8BEF",description:"\u8BF7\u4E0A\u4F20\u683C\u5F0F\u4E3A ".concat(V," \u7684\u6587\u4EF6")}),o(!1);else if(T&&D.size>T*O)De.default.error({message:"\u6587\u4EF6\u5927\u5C0F\u4E0D\u7B26\u5408\u8981\u6C42",description:"\u5355\u4E2A\u6587\u4EF6\u4E0D\u5F97\u8D85\u8FC7 ".concat(T,"M")}),o(!1);else if(0<(D==null?void 0:D.type.indexOf("image"))){var r=new FileReader;r.readAsDataURL(D),r.onload=function(c){var v,w=(v=c.target)===null||v===void 0?void 0:v.result,i=document.createElement("img");i.src=typeof w=="string"?w:void 0,i.onload=function(){(h>i.width||M>i.height)&&(De.default.error({message:"\u56FE\u50CF\u5C3A\u5BF8\u4E0D\u7B26\u5408\u8981\u6C42",description:"\u8BF7\u4E0A\u4F20\u5BBD\u9AD8\u5927\u4E8E\u6216\u7B49\u4E8E ".concat(h,"X").concat(M," \u7684\u56FE\u50CF")}),o(!1))}}}else n(!0)})},ve={action:B,disabled:s,multiple:y,accept:pe,listType:x,maxCount:X,fileList:ue,showUploadList:!1,data:a.extraData,onRemove:xe,onChange:ge,progress:{strokeColor:{"0%":"#108ee9","100%":"#87d068"},strokeWidth:3,showInfo:!1},className:a==null?void 0:a.className,headers:{Authorization:(Z=(_=localStorage)===null||_===void 0?void 0:_.getItem("access_token"))!==null&&Z!==void 0?Z:""},beforeUpload:function(D){return J(D).then(function(O){return O}).catch(function(O){return O})}};return(0,e.jsx)(e.Fragment,{children:Q?(0,e.jsx)(ke.Z,{"data-inspector-line":"226","data-inspector-column":"16","data-inspector-relative-path":"src\\pages\\components\\UploadAdapter\\index.tsx",grid:!0,quality:P,aspect:fe,modalTitle:"\u88C1\u526A\u56FE\u50CF",children:(0,e.jsx)(Me.Z,(0,g.Z)((0,g.Z)({"data-inspector-line":"227","data-inspector-column":"20","data-inspector-relative-path":"src\\pages\\components\\UploadAdapter\\index.tsx"},ve),{},{children:(0,e.jsx)(te.Z,{"data-inspector-line":"228","data-inspector-column":"24","data-inspector-relative-path":"src\\pages\\components\\UploadAdapter\\index.tsx",icon:s?(0,e.jsx)($e.Z,{"data-inspector-line":"228","data-inspector-column":"48","data-inspector-relative-path":"src\\pages\\components\\UploadAdapter\\index.tsx"}):(0,e.jsx)(ze.Z,{"data-inspector-line":"228","data-inspector-column":"70","data-inspector-relative-path":"src\\pages\\components\\UploadAdapter\\index.tsx"}),children:s?"Uploading":u})}))}):(0,e.jsx)(Me.Z,(0,g.Z)((0,g.Z)({"data-inspector-line":"232","data-inspector-column":"16","data-inspector-relative-path":"src\\pages\\components\\UploadAdapter\\index.tsx"},ve),{},{children:(0,e.jsx)(te.Z,{"data-inspector-line":"233","data-inspector-column":"20","data-inspector-relative-path":"src\\pages\\components\\UploadAdapter\\index.tsx",icon:s?(0,e.jsx)($e.Z,{"data-inspector-line":"233","data-inspector-column":"44","data-inspector-relative-path":"src\\pages\\components\\UploadAdapter\\index.tsx"}):(0,e.jsx)(ze.Z,{"data-inspector-line":"233","data-inspector-column":"66","data-inspector-relative-path":"src\\pages\\components\\UploadAdapter\\index.tsx"}),children:s?"Uploading":u})}))})},Xe=t(57119),Ye=t(25592),Ne=t(15873),Je=t(73218),Ke=t(73171),qe=t(95357),_e=function(){var a,A,U=Ue.Z.Text,$={1:"",2:"?x-oss-process=image/auto-orient,1/interlace,1/resize,m_lfit,w_150/quality,q_90",3:"?imageMogr2/thumbnail/150x/interlace/1/rquality/90"},S=(0,C.useRef)(),N=(0,C.useState)(0),W=(0,H.Z)(N,2),I=W[0],z=W[1],K=(0,C.useState)(),j=(0,H.Z)(K,2),Z=j[0],_=j[1],ce=(0,C.useState)(),Q=(0,H.Z)(ce,2),T=Q[0],X=Q[1],P=(0,C.useState)(0),u=(0,H.Z)(P,2),x=u[0],F=u[1],d=(0,G.tT)("file",function(i){return{setUploadList:i.setUploadList}}),s=d.setUploadList,m=(0,C.useState)([]),y=(0,H.Z)(m,2),h=y[0],M=y[1],B=(0,G.tT)("attach",function(i){return{span:i.span,limit:i.limit,cateId:i.cateId,isModal:i.isModal,setOpen:i.setOpen,cateData:i.cateData,cateInfo:i.cateInfo,multiple:i.multiple,setCateId:i.setCateId,pagination:i.pagination,setPagination:i.setPagination,setExpandedKeys:i.setExpandedKeys}}),le=B.limit,ue=B.cateId,L=B.isModal,fe=B.setOpen,pe=B.cateData,V=B.cateInfo,xe=B.multiple,ge=B.setCateId,J=B.pagination,ve=B.span,b=B.setPagination,D=B.setExpandedKeys,O=(0,G.QT)(me.pb,{manual:!0,defaultParams:[(0,g.Z)({id:0},J)],onSuccess:function(p){z(p==null?void 0:p.total),_(p==null?void 0:p.list),M([])}}),l=O.run,n=O.refresh,o=O.loading,r=function(){var i=(0,Ce.Z)(re().mark(function p(f){var ne,se;return re().wrap(function(ie){for(;;)switch(ie.prev=ie.next){case 0:return ne=[],h.forEach(function(k){return ne.push(k.id)}),se=(0,Se.f8)(pe,function(k){return k.id==Array.of(f)}),1<se.length&&se.pop(),ie.next=6,(0,me.pB)({id:ne,pid:f}).then(function(k){k!=null&&k.success&&(M([]),ae.default.success(k.msg),D(se),ge(Array.of(f)))});case 6:case"end":return ie.stop()}},p)}));return function(f){return i.apply(this,arguments)}}();(0,C.useEffect)(function(){X(function(){return Z==null?void 0:Z.filter(function(i){return 0<=(i==null?void 0:i.type.indexOf("image"))})})},[Z]),(0,C.useEffect)(function(){l((0,g.Z)({id:ue.at(0)},J))},[ue,l,J]);var c=function(p,f){var ne;p.stopPropagation(),T==null||T.forEach(function(se,Ie){f==se.id&&F(Ie)}),(ne=S.current)===null||ne===void 0||ne.imagePreview(!0)},v=function(){var p=h.map(function(f){return{status:"done",name:f.name,url:f.static_path,uid:f.id.toString()}});s(xe?function(f){return f.concat(p).slice(-le)}:p.slice(-le)),fe(!1)},w=function(p,f){p.stopPropagation(),Re.Z.confirm({centered:!0,cancelText:"\u7B97\u4E86",title:"\u5F53\u771F\u8981\u5220\u9664?",icon:(0,e.jsx)(Le.Z,{"data-inspector-line":"156","data-inspector-column":"18","data-inspector-relative-path":"src\\pages\\components\\Attach\\Previews\\index.tsx"}),cancelButtonProps:{shape:"round"},okButtonProps:{danger:!0,shape:"round"},content:(0,e.jsxs)(Y.Z,{"data-inspector-line":"160","data-inspector-column":"16","data-inspector-relative-path":"src\\pages\\components\\Attach\\Previews\\index.tsx",direction:"vertical",children:[(0,e.jsx)(U,{"data-inspector-line":"161","data-inspector-column":"20","data-inspector-relative-path":"src\\pages\\components\\Attach\\Previews\\index.tsx",children:f instanceof Array?"\u8FD9 ".concat(f.length," \u4E2A\u6587\u4EF6"):"".concat(f.name," \u8FD9\u4E2A\u6587\u4EF6")}),(0,e.jsxs)(U,{"data-inspector-line":"162","data-inspector-column":"20","data-inspector-relative-path":"src\\pages\\components\\Attach\\Previews\\index.tsx",type:"danger",children:[(0,e.jsx)(Xe.Z,{"data-inspector-line":"163","data-inspector-column":"24","data-inspector-relative-path":"src\\pages\\components\\Attach\\Previews\\index.tsx"})," \u6587\u4EF6\u4ECE\u5B58\u50A8\u4E2D\u5220\u9664\u540E\u5C06\u65E0\u6CD5\u6062\u590D"]})]}),onOk:function(){return(0,Ce.Z)(re().mark(function se(){return re().wrap(function(ie){for(;;)switch(ie.prev=ie.next){case 0:return ie.next=2,(0,me.Ao)({attach:f instanceof Array?f:Array.of(f)}).then(function(k){k!=null&&k.success&&(n(),M([]),ae.default.success(k.msg))});case 2:case"end":return ie.stop()}},se)}))()},onCancel:function(){M([])}})};return(0,e.jsxs)(de.Z,{"data-inspector-line":"183","data-inspector-column":"8","data-inspector-relative-path":"src\\pages\\components\\Attach\\Previews\\index.tsx",children:[(0,e.jsx)(ee.Z,{"data-inspector-line":"184","data-inspector-column":"12","data-inspector-relative-path":"src\\pages\\components\\Attach\\Previews\\index.tsx",span:24,children:(0,e.jsxs)(Y.Z,{"data-inspector-line":"185","data-inspector-column":"16","data-inspector-relative-path":"src\\pages\\components\\Attach\\Previews\\index.tsx",size:"middle",style:{marginBottom:"1rem"},children:[(0,e.jsx)(He,(0,g.Z)((0,g.Z)({"data-inspector-line":"186","data-inspector-column":"20","data-inspector-relative-path":"src\\pages\\components\\Attach\\Previews\\index.tsx",fetch:n},V==null?void 0:V.config),{},{formTitle:"\u4E0A\u4F20\u6587\u4EF6",extraData:{pid:(a=V==null?void 0:V.id)!==null&&a!==void 0?a:0,path:(A=V==null?void 0:V.dirname)!==null&&A!==void 0?A:"attach"}})),(0,e.jsx)(te.Z,{"data-inspector-line":"192","data-inspector-column":"20","data-inspector-relative-path":"src\\pages\\components\\Attach\\Previews\\index.tsx",icon:(0,e.jsx)(Ye.Z,{"data-inspector-line":"192","data-inspector-column":"34","data-inspector-relative-path":"src\\pages\\components\\Attach\\Previews\\index.tsx"}),onClick:n,children:"\u5237\u65B0\u5217\u8868"}),L?(0,e.jsx)(he.Z,{"data-inspector-line":"196","data-inspector-column":"24","data-inspector-relative-path":"src\\pages\\components\\Attach\\Previews\\index.tsx",count:h.length,children:(0,e.jsx)(te.Z,{"data-inspector-line":"197","data-inspector-column":"28","data-inspector-relative-path":"src\\pages\\components\\Attach\\Previews\\index.tsx",disabled:!h.length,icon:(0,e.jsx)(Ne.Z,{"data-inspector-line":"197","data-inspector-column":"73","data-inspector-relative-path":"src\\pages\\components\\Attach\\Previews\\index.tsx"}),onClick:function(){return v()},children:"\u4F7F\u7528\u9009\u4E2D"})}):(0,e.jsx)(he.Z,{"data-inspector-line":"202","data-inspector-column":"24","data-inspector-relative-path":"src\\pages\\components\\Attach\\Previews\\index.tsx",count:h.length,children:(0,e.jsx)(te.Z,{"data-inspector-line":"203","data-inspector-column":"28","data-inspector-relative-path":"src\\pages\\components\\Attach\\Previews\\index.tsx",icon:h.length?(0,e.jsx)(Je.Z,{"data-inspector-line":"204","data-inspector-column":"59","data-inspector-relative-path":"src\\pages\\components\\Attach\\Previews\\index.tsx"}):(0,e.jsx)(Ne.Z,{"data-inspector-line":"204","data-inspector-column":"85","data-inspector-relative-path":"src\\pages\\components\\Attach\\Previews\\index.tsx"}),onClick:function(){h.length?M([]):M(Z!=null?Z:[])},children:h.length?"\u6E05\u7A7A\u9009\u62E9":"\u5168\u90E8\u9009\u62E9"})}),(0,e.jsx)(te.Z,{"data-inspector-line":"213","data-inspector-column":"20","data-inspector-relative-path":"src\\pages\\components\\Attach\\Previews\\index.tsx",danger:!0,icon:(0,e.jsx)(Ke.Z,{"data-inspector-line":"215","data-inspector-column":"30","data-inspector-relative-path":"src\\pages\\components\\Attach\\Previews\\index.tsx"}),disabled:!h.length,onClick:function(p){return w(p,h)},children:"\u5220\u9664\u6587\u4EF6"}),(0,e.jsx)(Ze.Z,{"data-inspector-line":"221","data-inspector-column":"20","data-inspector-relative-path":"src\\pages\\components\\Attach\\Previews\\index.tsx",allowClear:!0,showSearch:!0,treeData:pe,placeholder:"\u79FB\u52A8\u81F3...",treeNodeFilterProp:"name",onChange:r,style:{minWidth:"150px"},disabled:!h.length,fieldNames:{label:"name",value:"id"}})]})}),(0,e.jsx)(ee.Z,{"data-inspector-line":"234","data-inspector-column":"12","data-inspector-relative-path":"src\\pages\\components\\Attach\\Previews\\index.tsx",span:24,children:(0,e.jsx)(ye.Z,{"data-inspector-line":"235","data-inspector-column":"16","data-inspector-relative-path":"src\\pages\\components\\Attach\\Previews\\index.tsx",spinning:o,tip:"Loading...",children:(0,e.jsx)(Te.tP.Group,{"data-inspector-line":"236","data-inspector-column":"20","data-inspector-relative-path":"src\\pages\\components\\Attach\\Previews\\index.tsx",size:"small",multiple:!0,style:{width:"100%"},value:h,onChange:function(p){return M(p)},children:(0,e.jsx)(de.Z,{"data-inspector-line":"243","data-inspector-column":"24","data-inspector-relative-path":"src\\pages\\components\\Attach\\Previews\\index.tsx",gutter:16,children:Z==null?void 0:Z.map(function(i){return(0,e.jsx)(ee.Z,{"data-inspector-line":"245","data-inspector-column":"32","data-inspector-relative-path":"src\\pages\\components\\Attach\\Previews\\index.tsx",span:L?4:ve.span,children:(0,e.jsx)(Te.tP,{"data-inspector-line":"246","data-inspector-column":"36","data-inspector-relative-path":"src\\pages\\components\\Attach\\Previews\\index.tsx",value:i,style:{overflow:"hidden",width:L?"100px":"150px",height:L?"100px":"150px"},cover:(0,e.jsxs)("div",{"data-inspector-line":"254","data-inspector-column":"44","data-inspector-relative-path":"src\\pages\\components\\Attach\\Previews\\index.tsx",className:"ant-image",children:[0<=(i==null?void 0:i.type.indexOf("image"))?(0,e.jsx)("img",{"data-inspector-line":"257","data-inspector-column":"52","data-inspector-relative-path":"src\\pages\\components\\Attach\\Previews\\index.tsx",alt:i.name,className:"ant-image-img",src:"".concat(i.real_path).concat($[i.storage])}):(0,e.jsx)("img",{"data-inspector-line":"263","data-inspector-column":"52","data-inspector-relative-path":"src\\pages\\components\\Attach\\Previews\\index.tsx",alt:"unknow",style:{width:"unset"},src:"/manage/unknow.svg"}),(0,e.jsx)("div",{"data-inspector-line":"265","data-inspector-column":"48","data-inspector-relative-path":"src\\pages\\components\\Attach\\Previews\\index.tsx",className:"ant-image-mask",children:(0,e.jsxs)(Y.Z,{"data-inspector-line":"266","data-inspector-column":"52","data-inspector-relative-path":"src\\pages\\components\\Attach\\Previews\\index.tsx",className:"ant-image-mask-info",children:[0<=(i==null?void 0:i.type.indexOf("image"))&&(0,e.jsx)(U,{"data-inspector-line":"269","data-inspector-column":"60","data-inspector-relative-path":"src\\pages\\components\\Attach\\Previews\\index.tsx",className:"anticon",onClick:function(f){return c(f,i.id)},children:(0,e.jsxs)("p",{"data-inspector-line":"270","data-inspector-column":"64","data-inspector-relative-path":"src\\pages\\components\\Attach\\Previews\\index.tsx",children:[(0,e.jsx)(qe.Z,{"data-inspector-line":"271","data-inspector-column":"68","data-inspector-relative-path":"src\\pages\\components\\Attach\\Previews\\index.tsx"}),!L&&"\u9884\u89C8"]})}),(0,e.jsx)(U,{"data-inspector-line":"276","data-inspector-column":"56","data-inspector-relative-path":"src\\pages\\components\\Attach\\Previews\\index.tsx",className:"anticon",onClick:function(f){return w(f,i)},children:(0,e.jsxs)("p",{"data-inspector-line":"277","data-inspector-column":"60","data-inspector-relative-path":"src\\pages\\components\\Attach\\Previews\\index.tsx",children:[(0,e.jsx)(Ke.Z,{"data-inspector-line":"278","data-inspector-column":"64","data-inspector-relative-path":"src\\pages\\components\\Attach\\Previews\\index.tsx"}),!L&&"\u5220\u9664"]})})]})})]})})},i.id)})})})})}),(0,e.jsx)(ee.Z,{"data-inspector-line":"293","data-inspector-column":"12","data-inspector-relative-path":"src\\pages\\components\\Attach\\Previews\\index.tsx",span:24,children:(0,e.jsx)(be.e,{"data-inspector-line":"294","data-inspector-column":"16","data-inspector-relative-path":"src\\pages\\components\\Attach\\Previews\\index.tsx",curIdx:x,ref:S,imgList:T!=null?T:[]})}),(0,e.jsx)(ee.Z,{"data-inspector-line":"296","data-inspector-column":"12","data-inspector-relative-path":"src\\pages\\components\\Attach\\Previews\\index.tsx",span:24,children:(0,e.jsx)(Fe.Z,{"data-inspector-line":"297","data-inspector-column":"16","data-inspector-relative-path":"src\\pages\\components\\Attach\\Previews\\index.tsx",responsive:!0,size:"small",total:I,hideOnSinglePage:!0,style:{float:"right"},current:J.current,pageSize:J.pageSize,pageSizeOptions:[24,32,56,86,102,120],defaultPageSize:L?24:J.pageSize,showTotal:function(p,f){return"\u7B2C ".concat(f[0],"-").concat(f[1]," \u6761/\u603B\u5171 ").concat(I," \u6761")},onChange:function(p,f){return b({current:p,pageSize:f})},onShowSizeChange:function(p,f){return b({current:p,pageSize:f})}})})]})},ft=t(32157),et=t(95033),xt=t(59250),tt=t(13013),gt=t(30887),at=t(28682),At=t(62350),nt=t(24565),yt=t(47673),it=t(4107),rt=t(96486),st=t.n(rt),E=t(22811),ot=(0,C.forwardRef)(function(R,a){var A=(0,C.useRef)(),U=(0,C.useState)(),$=(0,H.Z)(U,2),S=$[0],N=$[1],W=(0,G.QT)("/attach/default"),I=W.data,z=(0,G.tT)("attach",function(P){return{refresh:P.refresh,cateInfo:P.cateInfo,cateData:st().cloneDeep(P.cateData)}}),K=z.refresh,j=z.cateInfo,Z=z.cateData;(0,C.useImperativeHandle)(a,function(){return{setPid:function(u){return N(u)}}});var _=function(){var P=(0,Ce.Z)(re().mark(function u(x){var F,d,s;return re().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return s=R!=null&&R.path?(0,g.Z)((0,g.Z)({},x),{},{pid:S!=null?S:0}):(0,g.Z)((0,g.Z)({},x),{},{id:(F=j==null?void 0:j.id)!==null&&F!==void 0?F:0,pid:(d=S!=null?S:j==null?void 0:j.pid)!==null&&d!==void 0?d:0}),y.next=3,(0,me.a1)(s).then(function(h){(h==null?void 0:h.success)&&ae.default.success(h.msg)}).finally(function(){return K()});case 3:case"end":return y.stop()}},u)}));return function(x){return P.apply(this,arguments)}}(),ce=(0,C.useState)({cropRequire:!1,limitRequire:!1,astrictRequire:!1,fileExtRequire:!1,fileMimeRequire:!1}),Q=(0,H.Z)(ce,2),T=Q[0],X=Q[1];return(0,e.jsxs)(E.aN,{"data-inspector-line":"78","data-inspector-column":"8","data-inspector-relative-path":"src\\pages\\components\\Attach\\Directory\\modules\\index.tsx",drawerProps:{width:520,maskClosable:!1,destroyOnClose:!0,className:"create-drawer"},title:j!=null&&j.id?"\u7F16\u8F91\u76EE\u5F55":"\u65B0\u589E\u76EE\u5F55",submitter:{searchConfig:{resetText:"\u91CD\u7F6E"},submitButtonProps:{shape:"round"},resetButtonProps:{shape:"round",type:"default",onClick:function(){var u;return(u=A.current)===null||u===void 0?void 0:u.resetFields()}}},formRef:A,autoFocusFirstInput:!0,open:R.drawerOpen,validateTrigger:["onBlur"],onOpenChange:R.handleSetDrawerOpen,onFinish:function(u){return _(u).then(function(){return!0})},initialValues:R!=null&&R.path?{path:R.path,option:0}:j,children:[(0,e.jsx)(E.Ve,{"data-inspector-line":"107","data-inspector-column":"12","data-inspector-relative-path":"src\\pages\\components\\Attach\\Directory\\modules\\index.tsx",name:"path",hasFeedback:!0,label:"\u4E0A\u7EA7\u76EE\u5F55",placeholder:"\u8BF7\u9009\u62E9\u4E0A\u7EA7\u76EE\u5F55",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u4E0A\u7EA7\u9644\u4EF6\u76EE\u5F55"}],fieldProps:{showSearch:!0,changeOnSelect:!0,options:Z.map(function(P){return P.id||(P.disabled=!1),P}),onChange:function(u){return N(u.at(-1))},fieldNames:{label:"name",value:"id",children:"children"}},transform:function(u){return u instanceof Array?{path:u.join("-")}:{path:u}},convertValue:function(u){var x;return u instanceof Array?u:(x=u==null?void 0:u.split("-").map(Number))!==null&&x!==void 0?x:[0]}}),(0,e.jsx)(E.V,{"data-inspector-line":"128","data-inspector-column":"12","data-inspector-relative-path":"src\\pages\\components\\Attach\\Directory\\modules\\index.tsx",hasFeedback:!0,name:"name",label:"\u76EE\u5F55\u540D\u79F0",placeholder:"\u8BF7\u8F93\u5165\u76EE\u5F55\u540D\u79F0",fieldProps:{maxLength:64,showCount:!0,onBlur:function(u){var x;(R==null?void 0:R.path)&&((x=A.current)===null||x===void 0||x.setFieldValue("ename",(0,Se.Qh)(u.target.value).replace(/\s+/g,"")))}},rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u76EE\u5F55\u540D\u79F0"},{type:"string",pattern:/^[\u4e00-\u9fa5\w]+$/,message:"\u76EE\u5F55\u540D\u79F0\u4E0D\u5F97\u5305\u542B\u7279\u6B8A\u7B26\u53F7"}]}),(0,e.jsx)(E.V,{"data-inspector-line":"149","data-inspector-column":"12","data-inspector-relative-path":"src\\pages\\components\\Attach\\Directory\\modules\\index.tsx",hasFeedback:!0,name:"ename",label:"\u76EE\u5F55\u522B\u540D",tooltip:"\u7CFB\u7EDF\u81EA\u52A8\u751F\u6210",placeholder:"\u8BF7\u8F93\u5165\u76EE\u5F55\u522B\u540D",fieldProps:{maxLength:64,showCount:!0},rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u76EE\u5F55\u522B\u540D"},{type:"string",pattern:/^\w+$/,message:"\u76EE\u5F55\u522B\u540D\u53EA\u80FD\u662F\u5B57\u6BCD\u3001\u6570\u5B57\u548C\u4E0B\u5212\u7EBF\u7684\u7EC4\u5408"}]}),(0,e.jsx)(E.$O.Group,{"data-inspector-line":"164","data-inspector-column":"12","data-inspector-relative-path":"src\\pages\\components\\Attach\\Directory\\modules\\index.tsx",name:"option",label:"\u4E0A\u4F20\u914D\u7F6E",options:[{label:"\u9ED8\u8BA4\u914D\u7F6E",value:0},{label:"\u81EA\u5B9A\u4E49\u914D\u7F6E",value:1}]}),(0,e.jsx)(E.ie,{"data-inspector-line":"172","data-inspector-column":"12","data-inspector-relative-path":"src\\pages\\components\\Attach\\Directory\\modules\\index.tsx",name:["option"],children:function(u){var x=u.option;if(x)return[(0,e.jsxs)(E.UW,{"data-inspector-line":"176","data-inspector-column":"28","data-inspector-relative-path":"src\\pages\\components\\Attach\\Directory\\modules\\index.tsx",size:3,label:"\u914D\u7F6E\u9009\u9879",children:[(0,e.jsx)(E.V2,{"data-inspector-line":"177","data-inspector-column":"32","data-inspector-relative-path":"src\\pages\\components\\Attach\\Directory\\modules\\index.tsx",name:"limit",fieldProps:{onChange:function(d){var s;X(function(m){return(0,g.Z)((0,g.Z)({},m),{},{limitRequire:d.target.checked})}),!d.target.checked&&((s=A.current)===null||s===void 0||s.setFieldValue("size",void 0))}},children:"\u6587\u4EF6\u5927\u5C0F"}),(0,e.jsx)(E.V2,{"data-inspector-line":"188","data-inspector-column":"32","data-inspector-relative-path":"src\\pages\\components\\Attach\\Directory\\modules\\index.tsx",name:"astrict",fieldProps:{onChange:function(d){var s;X(function(m){return(0,g.Z)((0,g.Z)({},m),{},{astrictRequire:d.target.checked})}),!d.target.checked&&((s=A.current)===null||s===void 0||s.setFieldValue("astricts",void 0))}},children:"\u9650\u5236\u5BBD\u9AD8"}),(0,e.jsx)(E.V2,{"data-inspector-line":"199","data-inspector-column":"32","data-inspector-relative-path":"src\\pages\\components\\Attach\\Directory\\modules\\index.tsx",name:"crop",fieldProps:{onChange:function(d){var s;X(function(m){return(0,g.Z)((0,g.Z)({},m),{},{cropRequire:d.target.checked})}),!d.target.checked&&((s=A.current)===null||s===void 0||s.setFieldValue("aspects",void 0))}},children:"\u542F\u7528\u88C1\u526A"}),(0,e.jsx)(E.V2,{"data-inspector-line":"210","data-inspector-column":"32","data-inspector-relative-path":"src\\pages\\components\\Attach\\Directory\\modules\\index.tsx",name:"suff",fieldProps:{onChange:function(d){var s;X(function(m){return(0,g.Z)((0,g.Z)({},m),{},{fileExtRequire:d.target.checked})}),!d.target.checked&&((s=A.current)===null||s===void 0||s.setFieldValue("fileExt",void 0))}},children:"\u6587\u4EF6\u540E\u7F00"}),(0,e.jsx)(E.V2,{"data-inspector-line":"221","data-inspector-column":"32","data-inspector-relative-path":"src\\pages\\components\\Attach\\Directory\\modules\\index.tsx",name:"mime",fieldProps:{onChange:function(d){var s;X(function(m){return(0,g.Z)((0,g.Z)({},m),{},{fileMimeRequire:d.target.checked})}),!d.target.checked&&((s=A.current)===null||s===void 0||s.setFieldValue("fileMime",void 0))}},children:"\u6587\u4EF6\u7C7B\u578B"})]},"options"),(0,e.jsx)(E.ie,{"data-inspector-line":"233","data-inspector-column":"28","data-inspector-relative-path":"src\\pages\\components\\Attach\\Directory\\modules\\index.tsx",name:["limit"],children:function(d){var s=d.limit;if(s)return(0,e.jsx)(E.k_,{"data-inspector-line":"237","data-inspector-column":"44","data-inspector-relative-path":"src\\pages\\components\\Attach\\Directory\\modules\\index.tsx",max:512,width:150,name:"size",label:"\u6587\u4EF6\u5927\u5C0F",tooltip:"\u4E0A\u4F20\u6587\u4EF6\u7684\u5927\u5C0F",fieldProps:{precision:0,addonAfter:"MB"},rules:[{required:T.limitRequire,message:"\u8BF7\u8BBE\u7F6E\u6587\u4EF6\u5927\u5C0F\u503C"}]},"size")}},"limit"),(0,e.jsx)(E.ie,{"data-inspector-line":"256","data-inspector-column":"28","data-inspector-relative-path":"src\\pages\\components\\Attach\\Directory\\modules\\index.tsx",name:["astrict"],children:function(d){var s=d.astrict;if(s)return[(0,e.jsx)(E.e9,{"data-inspector-line":"260","data-inspector-column":"44","data-inspector-relative-path":"src\\pages\\components\\Attach\\Directory\\modules\\index.tsx",name:"astricts",label:"\u9650\u5236\u5BBD\u9AD8",tooltip:"\u9650\u5236\u56FE\u50CF\u6700\u5C0F\u5BBD\u9AD8",fieldProps:{precision:0,addonAfter:"PX",onBlur:function(y){return y.stopPropagation()}},rules:[function(){return{validator:function(y,h){return h instanceof Array&&h.filter(function(M){return typeof M=="number"}).length==2?Promise.resolve():Promise.reject("\u8BF7\u5B8C\u5584\u56FE\u50CF\u5BBD\u9AD8\u53C2\u6570")}}}]},"astricts")]}},"astrict"),(0,e.jsx)(E.ie,{"data-inspector-line":"287","data-inspector-column":"28","data-inspector-relative-path":"src\\pages\\components\\Attach\\Directory\\modules\\index.tsx",name:["crop"],children:function(d){var s=d.crop;if(s)return[(0,e.jsx)(E.e9,{"data-inspector-line":"291","data-inspector-column":"44","data-inspector-relative-path":"src\\pages\\components\\Attach\\Directory\\modules\\index.tsx",name:"aspects",label:"\u88C1\u526A\u6BD4\u4F8B",tooltip:"\u9700\u4E3A\u6B63\u6574\u6570",fieldProps:{precision:0,onBlur:function(y){return y.stopPropagation()}},rules:[function(){return{validator:function(y,h){return h instanceof Array&&h.filter(function(M){return typeof M=="number"}).length==2?Promise.resolve():Promise.reject("\u8BF7\u5B8C\u5584\u88C1\u526A\u6BD4\u4F8B\u53C2\u6570")}}}]},"aspects")]}},"crop"),(0,e.jsx)(E.ie,{"data-inspector-line":"317","data-inspector-column":"28","data-inspector-relative-path":"src\\pages\\components\\Attach\\Directory\\modules\\index.tsx",name:["suff"],children:function(d){var s=d.suff;if(s){var m;return[(0,e.jsx)(E._I,{"data-inspector-line":"321","data-inspector-column":"44","data-inspector-relative-path":"src\\pages\\components\\Attach\\Directory\\modules\\index.tsx",name:"fileExt",label:"\u6587\u4EF6\u540E\u7F00",tooltip:"\u9650\u5236\u4E0A\u4F20\u7684\u6587\u4EF6\u540E\u7F00",fieldProps:{mode:"tags",maxTagCount:13,options:I==null||(m=I.list.fileExt)===null||m===void 0?void 0:m.map(function(y){return{label:y,value:y}})},rules:[{required:T.fileExtRequire,message:"\u8BF7\u8BBE\u7F6E\u6587\u4EF6\u540E\u7F00"}]},"fileExt")]}else return}},"suff"),(0,e.jsx)(E.ie,{"data-inspector-line":"342","data-inspector-column":"28","data-inspector-relative-path":"src\\pages\\components\\Attach\\Directory\\modules\\index.tsx",name:["mime"],children:function(d){var s=d.mime;if(s){var m;return[(0,e.jsx)(E._I,{"data-inspector-line":"346","data-inspector-column":"44","data-inspector-relative-path":"src\\pages\\components\\Attach\\Directory\\modules\\index.tsx",name:"fileMime",label:"\u6587\u4EF6\u7C7B\u578B",tooltip:"\u9650\u5236\u4E0A\u4F20\u7684\u6587\u4EF6\u7C7B\u578B",fieldProps:{mode:"tags",maxTagCount:10,options:I==null||(m=I.list.fileMime)===null||m===void 0?void 0:m.map(function(y){return{label:y,value:y}})},rules:[{required:T.fileMimeRequire,message:"\u8BF7\u8BBE\u7F6E\u6587\u4EF6\u7C7B\u578B"}]},"fileMime")]}else return}},"mime")]}})]})}),ct=t(44545),lt=function(){var a=it.Z.Search,A=Ue.Z.Text,U=(0,C.useState)(),$=(0,H.Z)(U,2),S=$[0],N=$[1],W=(0,C.useRef)(),I=(0,C.useState)(""),z=(0,H.Z)(I,2),K=z[0],j=z[1],Z=(0,C.useState)(!1),_=(0,H.Z)(Z,2),ce=_[0],Q=_[1],T=(0,C.useState)(!0),X=(0,H.Z)(T,2),P=X[0],u=X[1],x=(0,G.tT)("attach",function(l){return{cateId:l.cateId,loading:l.loading,refresh:l.refresh,getInfo:l.getInfo,isModal:l.isModal,cateData:l.cateData,setCateId:l.setCateId,setCateInfo:l.setCateInfo,expandedKeys:l.expandedKeys,setPagination:l.setPagination,setExpandedKeys:l.setExpandedKeys}}),F=x.cateId,d=x.getInfo,s=x.refresh,m=x.loading,y=x.isModal,h=x.cateData,M=x.setCateId,B=x.setCateInfo,le=x.expandedKeys,ue=x.setPagination,L=x.setExpandedKeys,fe=function l(n,o){for(var r,c=0;c<o.length;c++){var v=o[c];v.children&&(v.children.some(function(w){return w.id===n})?r=v.id:l(n,v.children)&&(r=l(n,v.children)))}return r},pe=function(n,o){var r;switch(n.key){case"update":n.domEvent.stopPropagation(),d({id:o}).then(function(){(0,Se.pQ)().then(function(){return Q(!0)})});break;case"create":n.domEvent.stopPropagation(),(r=W.current)===null||r===void 0||r.setPid(o),o?d({id:o}).then(function(c){N(c==null?void 0:c.info.path.split("-").map(Number).concat(o).filter(function(v){return v}))}).finally(function(){return Q(!0)}):(N([0]),Q(!0),B(void 0));break;default:n.domEvent.stopPropagation()}},V=function(){var l=(0,Ce.Z)(re().mark(function n(o){return re().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,(0,me.Od)({id:o}).then(function(v){return(v==null?void 0:v.success)&&ae.default.success(v.msg),v==null?void 0:v.success}).finally(function(){return s()});case 2:return c.abrupt("return",c.sent);case 3:case"end":return c.stop()}},n)}));return function(o){return l.apply(this,arguments)}}(),xe=function(n){var o=[{key:"create",label:"\u65B0\u589E\u76EE\u5F55"},{key:"update",label:"\u7F16\u8F91\u76EE\u5F55"},{key:"delete",label:(0,e.jsx)(nt.Z,{"data-inspector-line":"144","data-inspector-column":"20","data-inspector-relative-path":"src\\pages\\components\\Attach\\Directory\\index.tsx",title:"\u786E\u8BA4\u5220\u9664\u8BE5\u76EE\u5F55?",onConfirm:function(){return V(n)},children:(0,e.jsx)(A,{"data-inspector-line":"145","data-inspector-column":"24","data-inspector-relative-path":"src\\pages\\components\\Attach\\Directory\\index.tsx",children:"\u5220\u9664\u76EE\u5F55"})})}];return(0,e.jsx)(at.Z,{"data-inspector-line":"151","data-inspector-column":"15","data-inspector-relative-path":"src\\pages\\components\\Attach\\Directory\\index.tsx",onClick:function(c){return pe(c,n)},items:n!=0?o:o.splice(0,1)})},ge=function(n){return(0,e.jsxs)("div",{"data-inspector-line":"161","data-inspector-column":"12","data-inspector-relative-path":"src\\pages\\components\\Attach\\Directory\\index.tsx",className:"customRender",children:[(0,e.jsx)(A,{"data-inspector-line":"162","data-inspector-column":"16","data-inspector-relative-path":"src\\pages\\components\\Attach\\Directory\\index.tsx",children:n.title}),(0,e.jsx)(tt.Z,{"data-inspector-line":"163","data-inspector-column":"16","data-inspector-relative-path":"src\\pages\\components\\Attach\\Directory\\index.tsx",trigger:["click"],placement:"bottomRight",overlay:function(){return xe(n.key)},getPopupContainer:function(r){return r.parentNode},children:(0,e.jsx)(A,{"data-inspector-line":"169","data-inspector-column":"20","data-inspector-relative-path":"src\\pages\\components\\Attach\\Directory\\index.tsx",onClick:function(r){return r==null?void 0:r.stopPropagation()},children:(0,e.jsx)(ct.Z,{"data-inspector-line":"170","data-inspector-column":"24","data-inspector-relative-path":"src\\pages\\components\\Attach\\Directory\\index.tsx",className:"overlayDropDown"})})})]})},J=[],ve=function l(n){for(var o=0;o<n.length;o++){var r=n[o],c=r.id,v=r.name;J.push({key:c,title:v}),r.children&&l(r.children)}};ve(h);var b=function(n){L(n),u(!1)},D=function(n){var o=n.target.value,r=J.map(function(c){return o&&c.title.indexOf(o)>-1?fe(c.key,h):null}).filter(function(c,v,w){return c&&w.indexOf(c)===v});j(o),u(!0),L(r)},O=(0,C.useMemo)(function(){var l=function n(o){return o.map(function(r){var c=r.name,v=c.indexOf(K),w=c.substring(0,v),i=c.slice(v+K.length),p=v>-1?(0,e.jsxs)("span",{"data-inspector-line":"240","data-inspector-column":"8","data-inspector-relative-path":"src\\pages\\components\\Attach\\Directory\\index.tsx",children:[w,(0,e.jsx)("span",{"data-inspector-line":"242","data-inspector-column":"28","data-inspector-relative-path":"src\\pages\\components\\Attach\\Directory\\index.tsx",className:"site-tree-search-value",children:K}),i]}):(0,e.jsx)("span",{"data-inspector-line":"245","data-inspector-column":"24","data-inspector-relative-path":"src\\pages\\components\\Attach\\Directory\\index.tsx",children:c});return r.children?{title:p,key:r.id,children:n(r.children)}:{title:p,key:r.id}})};return l(h)},[h,K]);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(a,{"data-inspector-line":"260","data-inspector-column":"12","data-inspector-relative-path":"src\\pages\\components\\Attach\\Directory\\index.tsx",allowClear:!0,onChange:D,className:"treeSearch",placeholder:"\u8BF7\u8F93\u5165\u5206\u7C7B\u540D\u79F0"}),(0,e.jsx)(ye.Z,{"data-inspector-line":"261","data-inspector-column":"12","data-inspector-relative-path":"src\\pages\\components\\Attach\\Directory\\index.tsx",spinning:m,tip:"Loading...",children:(0,e.jsx)(et.Z,{"data-inspector-line":"262","data-inspector-column":"16","data-inspector-relative-path":"src\\pages\\components\\Attach\\Directory\\index.tsx",treeData:O,onExpand:b,selectedKeys:F,defaultSelectedKeys:[0],titleRender:ge,expandedKeys:le,height:y?490:void 0,autoExpandParent:P,rootClassName:y?"modalTree":"normalTree",onSelect:function(n,o){var r=o.selected;r&&M(n),r&&!n.at(0)&&B(void 0),r&&n.at(0)&&d({id:n.at(0)}),r&&ue(function(c){return{current:1,pageSize:c.pageSize}})}})}),(0,e.jsx)(ot,{"data-inspector-line":"283","data-inspector-column":"12","data-inspector-relative-path":"src\\pages\\components\\Attach\\Directory\\index.tsx",path:S,ref:W,drawerOpen:ce,handleSetDrawerOpen:function(n){Q(n),!n&&N(void 0)}})]})},dt=function(a){var A,U,$,S=(A=a==null?void 0:a.gutter)!==null&&A!==void 0?A:[32,32],N=(U=a==null?void 0:a.previewSpan)!==null&&U!==void 0?U:20,W=($=a==null?void 0:a.directorySpan)!==null&&$!==void 0?$:4,I=(0,G.tT)("attach",function(K){return{run:K.run}}),z=I.run;return(0,C.useEffect)(function(){z({pid:0})},[z]),(0,e.jsxs)(de.Z,{"data-inspector-line":"38","data-inspector-column":"8","data-inspector-relative-path":"src\\pages\\components\\Attach\\index.tsx",gutter:S,style:{padding:"16px"},children:[(0,e.jsx)(ee.Z,{"data-inspector-line":"39","data-inspector-column":"12","data-inspector-relative-path":"src\\pages\\components\\Attach\\index.tsx",span:W,children:(0,e.jsx)(lt,{"data-inspector-line":"40","data-inspector-column":"16","data-inspector-relative-path":"src\\pages\\components\\Attach\\index.tsx"})}),(0,e.jsx)(ee.Z,{"data-inspector-line":"42","data-inspector-column":"12","data-inspector-relative-path":"src\\pages\\components\\Attach\\index.tsx",span:N,children:(0,e.jsx)(_e,{"data-inspector-line":"43","data-inspector-column":"16","data-inspector-relative-path":"src\\pages\\components\\Attach\\index.tsx"})})]})}},21940:function(Ve,je,t){"use strict";t.d(je,{e:function(){return Fe}});var We=t(12968),de=t(40610),Be=t(2824),ee=t(75860),G=t(67294),Ae=t(85893),Fe=(0,G.forwardRef)(function(oe,ye){var Pe,Ze=(Pe=oe==null?void 0:oe.curIdx)!==null&&Pe!==void 0?Pe:0,Oe=(0,G.useState)(!1),he=(0,Be.Z)(Oe,2),we=he[0],te=he[1];return(0,G.useImperativeHandle)(ye,function(){return{imagePreview:function(Y){return te(Y)}}}),(0,Ae.jsx)("div",{"data-inspector-line":"28","data-inspector-column":"8","data-inspector-relative-path":"src\\pages\\components\\ImagePreview\\index.tsx",style:{display:"none"},children:(0,Ae.jsx)(de.Z.PreviewGroup,{"data-inspector-line":"29","data-inspector-column":"12","data-inspector-relative-path":"src\\pages\\components\\ImagePreview\\index.tsx",preview:{visible:we,current:Ze,onVisibleChange:function(Y){return te(Y)}},children:oe==null?void 0:oe.imgList.map(function(q){var Y,Ee;return(0,Ae.jsx)(de.Z,{"data-inspector-line":"31","data-inspector-column":"20","data-inspector-relative-path":"src\\pages\\components\\ImagePreview\\index.tsx",src:(Ee=q==null?void 0:q.url)!==null&&Ee!==void 0?Ee:q.static_path},(Y=q==null?void 0:q.id)!==null&&Y!==void 0?Y:(0,ee.O1)(4))})})})})}}]);
