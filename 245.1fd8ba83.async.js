(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[245],{40245:function(we,Pe,n){"use strict";n.d(Pe,{b:function(){return cn}});var We=n(13062),de=n(71230),Oe=n(89032),ee=n(15746),G=n(21010),Ee=n(14781),Se=n(23492),le=n(20228),Ce=n(11382),ye=n(62999),De=n(95216),Ae=n(54029),he=n(79166),Re=n(57663),ne=n(71577),q=n(49111),Y=n(19650),je=n(71194),Te=n(97022),fn=n(34792),te=n(48086),Fe=n(3182),x=n(11849),H=n(2824),vn=n(402),Me=n(95574),Qe=n(94043),ue=n.n(Qe),Ie=n(75860),Le=n(59886),be=n(21940),me=n(22369),hn=n(43185),$e=n(9053),mn=n(74379),Ze=n(38648),gn=n(66126),ke=n(7789),F=n(67294),Ge=n(36571),Ue=n(1870),ze=n(7085),Ne=n(62298),e=n(85893),He=function(t){var E,M,z,I,K,W,B,N,V,P,D,_,oe=Te.Z.confirm,Q=(E=t==null?void 0:t.crop)!==null&&E!==void 0?E:0,L=(M=t==null?void 0:t.size)!==null&&M!==void 0?M:0,X=(z=t==null?void 0:t.maxUpload)!==null&&z!==void 0?z:0,y=(I=t==null?void 0:t.cropQuality)!==null&&I!==void 0?I:.6,c=(K=t==null?void 0:t.formTitle)!==null&&K!==void 0?K:"\u4E0A\u4F20\u56FE\u50CF",p=(W=t==null?void 0:t.listType)!==null&&W!==void 0?W:"text",S=(0,F.useState)(!1),d=(0,H.Z)(S,2),r=d[0],m=d[1],C=Q?!1:(B=t==null?void 0:t.multiple)!==null&&B!==void 0?B:!0,h=t!=null&&t.astricts?t.astricts[0]:0,$=t!=null&&t.astricts?t.astricts[1]:0,O=(N=t==null?void 0:t.uploadUrl)!==null&&N!==void 0?N:"/console/attach/upload",se=(0,G.tT)("file",function(b){return{uploadList:b.uploadList,setUploadList:b.setUploadList}}),ce=se.uploadList,U=se.setUploadList,ge=t!=null&&t.aspects?t.aspects[0]/t.aspects[1]:1,fe=t==null||(V=t.fileExt)===null||V===void 0?void 0:V.map(function(b){return".".concat(b)}).join(","),w=(P=t==null?void 0:t.fileMime)!==null&&P!==void 0?P:["video/mp4","image/png","image/gif","image/jpeg","audio/mpeg","image/x-icon","application/vnd.ms-works","application/vnd.ms-excel","image/vnd.microsoft.icon","application/octet-stream","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],pe=function(Z){return new Promise(function(A,s){var a,l,u=(a=Z==null?void 0:Z.url)!==null&&a!==void 0?a:"",o;1<u.indexOf(".cn/")&&(o=u.substring(u.indexOf(".cn/")+4)),oe({centered:!0,cancelText:"\u7B97\u4E86",title:"\u5F53\u771F\u8981\u5220\u9664?",icon:(0,e.jsx)(Ue.Z,{}),cancelButtonProps:{shape:"round"},okButtonProps:{danger:!0,shape:"round"},content:(l=u.match(/\/(\w+\.(?:png|jpg|gif|bmp))$/i))===null||l===void 0?void 0:l[1],onOk:function(){var R;(0,Ge.Yd)({filePath:(R=o)!==null&&R!==void 0?R:u}).then(function(i){i!=null&&i.success?A(!0):s("error")})},onCancel:function(){s("onCancel")}})})},xe=function(Z){var A,s,a=Z.file,l=Z.fileList;U(l.slice());var u=Z.file.status;switch(u){case"uploading":m(!0),te.default.info("File ".concat(a.name," is uploading..."));break;case"success":te.default.success("File ".concat(a.name," uploaded successfully"));break;case"removed":U(l),te.default.success("File ".concat(a.name," removed successfully"));break;case"error":Ze.default.error({message:"Error",description:(A=a==null||(s=a.response)===null||s===void 0?void 0:s.msg)!==null&&A!==void 0?A:"File ".concat(a.name," upload failed")});break;case"done":t.fetch(),m(!1);var o=a.response.msg,v=a.response.success;U(function(R){var i;return R.concat([(0,x.Z)((0,x.Z)({},a==null||(i=a.response)===null||i===void 0?void 0:i.data),{},{status:"done"})]).filter(function(f){return!(f!=null&&f.response)})}),v?te.default.success("File ".concat(a.name," ").concat(o)):(U([]),te.default.error("File ".concat(a.name," ").concat(o)));break;case void 0:m(!1),U([]);break;default:throw new Error("Not implemented yet: undefined case")}},J=function(Z){var A=1024*1024,s=Z.type;return new Promise(function(a,l){if(!w.includes(s))Ze.default.error({message:"\u6587\u4EF6\u7C7B\u578B\u9519\u8BEF",description:"\u8BF7\u4E0A\u4F20\u683C\u5F0F\u4E3A ".concat(w," \u7684\u6587\u4EF6")}),l(!1);else if(L&&Z.size>L*A)Ze.default.error({message:"\u6587\u4EF6\u5927\u5C0F\u4E0D\u7B26\u5408\u8981\u6C42",description:"\u5355\u4E2A\u6587\u4EF6\u4E0D\u5F97\u8D85\u8FC7 ".concat(L,"M")}),l(!1);else if(0<(Z==null?void 0:Z.type.indexOf("image"))){var u=new FileReader;u.readAsDataURL(Z),u.onload=function(o){var v,R=(v=o.target)===null||v===void 0?void 0:v.result,i=document.createElement("img");i.src=typeof R=="string"?R:void 0,i.onload=function(){(h>i.width||$>i.height)&&(Ze.default.error({message:"\u56FE\u50CF\u5C3A\u5BF8\u4E0D\u7B26\u5408\u8981\u6C42",description:"\u8BF7\u4E0A\u4F20\u5BBD\u9AD8\u5927\u4E8E\u6216\u7B49\u4E8E ".concat(h,"X").concat($," \u7684\u56FE\u50CF")}),l(!1))}}}else a(!0)})},ve={action:O,disabled:r,multiple:C,accept:fe,listType:p,maxCount:X,fileList:ce,showUploadList:!1,data:t.extraData,onRemove:pe,onChange:xe,progress:{strokeColor:{"0%":"#108ee9","100%":"#87d068"},strokeWidth:3,showInfo:!1},className:t==null?void 0:t.className,headers:{Authorization:(D=(_=localStorage)===null||_===void 0?void 0:_.getItem("access_token"))!==null&&D!==void 0?D:""},beforeUpload:function(Z){return J(Z).then(function(A){return A}).catch(function(A){return A})}};return(0,e.jsx)(e.Fragment,{children:Q?(0,e.jsx)(ke.Z,{grid:!0,quality:y,aspect:ge,modalTitle:"\u88C1\u526A\u56FE\u50CF",children:(0,e.jsx)($e.Z,(0,x.Z)((0,x.Z)({},ve),{},{children:(0,e.jsx)(ne.Z,{icon:r?(0,e.jsx)(ze.Z,{}):(0,e.jsx)(Ne.Z,{}),children:r?"Uploading":c})}))}):(0,e.jsx)($e.Z,(0,x.Z)((0,x.Z)({},ve),{},{children:(0,e.jsx)(ne.Z,{icon:r?(0,e.jsx)(ze.Z,{}):(0,e.jsx)(Ne.Z,{}),children:r?"Uploading":c})}))})},Xe=n(57119),Ye=n(25592),Ke=n(15873),Je=n(73218),Ve=n(73171),qe=n(95357),_e=function(){var t,E,M=Me.Z.Text,z={1:"",2:"?x-oss-process=image/auto-orient,1/interlace,1/resize,m_lfit,w_150/quality,q_90",3:"?imageMogr2/thumbnail/150x/interlace/1/rquality/90"},I=(0,F.useRef)(),K=(0,F.useState)(0),W=(0,H.Z)(K,2),B=W[0],N=W[1],V=(0,F.useState)(),P=(0,H.Z)(V,2),D=P[0],_=P[1],oe=(0,F.useState)(),Q=(0,H.Z)(oe,2),L=Q[0],X=Q[1],y=(0,F.useState)(0),c=(0,H.Z)(y,2),p=c[0],S=c[1],d=(0,G.tT)("file",function(i){return{setUploadList:i.setUploadList}}),r=d.setUploadList,m=(0,F.useState)([]),C=(0,H.Z)(m,2),h=C[0],$=C[1],O=(0,G.tT)("attach",function(i){return{span:i.span,limit:i.limit,cateId:i.cateId,isModal:i.isModal,setOpen:i.setOpen,cateData:i.cateData,cateInfo:i.cateInfo,multiple:i.multiple,setCateId:i.setCateId,pagination:i.pagination,setPagination:i.setPagination,setExpandedKeys:i.setExpandedKeys}}),se=O.limit,ce=O.cateId,U=O.isModal,ge=O.setOpen,fe=O.cateData,w=O.cateInfo,pe=O.multiple,xe=O.setCateId,J=O.pagination,ve=O.span,b=O.setPagination,Z=O.setExpandedKeys,A=(0,G.QT)(me.pb,{manual:!0,defaultParams:[(0,x.Z)({id:0},J)],onSuccess:function(f){N(f==null?void 0:f.total),_(f==null?void 0:f.list),$([])}}),s=A.run,a=A.refresh,l=A.loading,u=function(){var i=(0,Fe.Z)(ue().mark(function f(g){var ae,re;return ue().wrap(function(ie){for(;;)switch(ie.prev=ie.next){case 0:return ae=[],h.forEach(function(k){return ae.push(k.id)}),re=(0,Ie.f8)(fe,function(k){return k.id==Array.of(g)}),1<re.length&&re.pop(),ie.next=6,(0,me.pB)({id:ae,pid:g}).then(function(k){k!=null&&k.success&&($([]),te.default.success(k.msg),Z(re),xe(Array.of(g)))});case 6:case"end":return ie.stop()}},f)}));return function(g){return i.apply(this,arguments)}}();(0,F.useEffect)(function(){X(function(){return D==null?void 0:D.filter(function(i){return 0<=(i==null?void 0:i.type.indexOf("image"))})})},[D]),(0,F.useEffect)(function(){s((0,x.Z)({id:ce.at(0)},J))},[ce,s,J]);var o=function(f,g){var ae;f.stopPropagation(),L==null||L.forEach(function(re,Be){g==re.id&&S(Be)}),(ae=I.current)===null||ae===void 0||ae.imagePreview(!0)},v=function(){var f=h.map(function(g){return{status:"done",name:g.name,url:g.static_path,uid:g.id.toString()}});r(pe?function(g){return g.concat(f).slice(-se)}:f.slice(-se)),ge(!1)},R=function(f,g){f.stopPropagation(),Te.Z.confirm({centered:!0,cancelText:"\u7B97\u4E86",title:"\u5F53\u771F\u8981\u5220\u9664?",icon:(0,e.jsx)(Ue.Z,{}),cancelButtonProps:{shape:"round"},okButtonProps:{danger:!0,shape:"round"},content:(0,e.jsxs)(Y.Z,{direction:"vertical",children:[(0,e.jsx)(M,{children:g instanceof Array?"\u8FD9 ".concat(g.length," \u4E2A\u6587\u4EF6"):"".concat(g.name," \u8FD9\u4E2A\u6587\u4EF6")}),(0,e.jsxs)(M,{type:"danger",children:[(0,e.jsx)(Xe.Z,{})," \u6587\u4EF6\u4ECE\u5B58\u50A8\u4E2D\u5220\u9664\u540E\u5C06\u65E0\u6CD5\u6062\u590D"]})]}),onOk:function(){return(0,Fe.Z)(ue().mark(function re(){return ue().wrap(function(ie){for(;;)switch(ie.prev=ie.next){case 0:return ie.next=2,(0,me.Ao)({attach:g instanceof Array?g:Array.of(g)}).then(function(k){k!=null&&k.success&&(a(),$([]),te.default.success(k.msg))});case 2:case"end":return ie.stop()}},re)}))()},onCancel:function(){$([])}})};return(0,e.jsxs)(de.Z,{children:[(0,e.jsx)(ee.Z,{span:24,children:(0,e.jsxs)(Y.Z,{size:"middle",style:{marginBottom:"1rem"},children:[(0,e.jsx)(He,(0,x.Z)((0,x.Z)({fetch:a},w==null?void 0:w.config),{},{formTitle:"\u4E0A\u4F20\u6587\u4EF6",extraData:{pid:(t=w==null?void 0:w.id)!==null&&t!==void 0?t:0,path:(E=w==null?void 0:w.dirname)!==null&&E!==void 0?E:"attach"}})),(0,e.jsx)(ne.Z,{icon:(0,e.jsx)(Ye.Z,{}),onClick:a,children:"\u5237\u65B0\u5217\u8868"}),U?(0,e.jsx)(he.Z,{count:h.length,children:(0,e.jsx)(ne.Z,{disabled:!h.length,icon:(0,e.jsx)(Ke.Z,{}),onClick:function(){return v()},children:"\u4F7F\u7528\u9009\u4E2D"})}):(0,e.jsx)(he.Z,{count:h.length,children:(0,e.jsx)(ne.Z,{icon:h.length?(0,e.jsx)(Je.Z,{}):(0,e.jsx)(Ke.Z,{}),onClick:function(){h.length?$([]):$(D!=null?D:[])},children:h.length?"\u6E05\u7A7A\u9009\u62E9":"\u5168\u90E8\u9009\u62E9"})}),(0,e.jsx)(ne.Z,{danger:!0,icon:(0,e.jsx)(Ve.Z,{}),disabled:!h.length,onClick:function(f){return R(f,h)},children:"\u5220\u9664\u6587\u4EF6"}),(0,e.jsx)(De.Z,{allowClear:!0,showSearch:!0,treeData:fe,placeholder:"\u79FB\u52A8\u81F3...",treeNodeFilterProp:"name",onChange:u,style:{minWidth:"150px"},disabled:!h.length,fieldNames:{label:"name",value:"id"}})]})}),(0,e.jsx)(ee.Z,{span:24,children:(0,e.jsx)(Ce.Z,{spinning:l,tip:"Loading...",children:(0,e.jsx)(Le.tP.Group,{size:"small",multiple:!0,style:{width:"100%"},value:h,onChange:function(f){return $(f)},children:(0,e.jsx)(de.Z,{gutter:16,children:D==null?void 0:D.map(function(i){return(0,e.jsx)(ee.Z,{span:U?4:ve.span,children:(0,e.jsx)(Le.tP,{value:i,style:{overflow:"hidden",width:U?"100px":"150px",height:U?"100px":"150px"},cover:(0,e.jsxs)("div",{className:"ant-image",children:[0<=(i==null?void 0:i.type.indexOf("image"))?(0,e.jsx)("img",{alt:i.name,className:"ant-image-img",src:"".concat(i.real_path).concat(z[i.storage])}):(0,e.jsx)("img",{alt:"unknow",style:{width:"unset"},src:"/manage/unknow.svg"}),(0,e.jsx)("div",{className:"ant-image-mask",children:(0,e.jsxs)(Y.Z,{className:"ant-image-mask-info",children:[0<=(i==null?void 0:i.type.indexOf("image"))&&(0,e.jsx)(M,{className:"anticon",onClick:function(g){return o(g,i.id)},children:(0,e.jsxs)("p",{children:[(0,e.jsx)(qe.Z,{}),!U&&"\u9884\u89C8"]})}),(0,e.jsx)(M,{className:"anticon",onClick:function(g){return R(g,i)},children:(0,e.jsxs)("p",{children:[(0,e.jsx)(Ve.Z,{}),!U&&"\u5220\u9664"]})})]})})]})})},i.id)})})})})}),(0,e.jsx)(ee.Z,{span:24,children:(0,e.jsx)(be.e,{curIdx:p,ref:I,imgList:L!=null?L:[]})}),(0,e.jsx)(ee.Z,{span:24,children:(0,e.jsx)(Se.Z,{responsive:!0,size:"small",total:B,hideOnSinglePage:!0,style:{float:"right"},current:J.current,pageSize:J.pageSize,pageSizeOptions:[24,32,56,86,102,120],defaultPageSize:U?24:J.pageSize,showTotal:function(f,g){return"\u7B2C ".concat(g[0],"-").concat(g[1]," \u6761/\u603B\u5171 ").concat(B," \u6761")},onChange:function(f,g){return b({current:f,pageSize:g})},onShowSizeChange:function(f,g){return b({current:f,pageSize:g})}})})]})},pn=n(32157),en=n(95033),xn=n(59250),nn=n(13013),En=n(30887),tn=n(28682),Cn=n(62350),an=n(24565),yn=n(47673),un=n(4107),rn=n(96486),ln=n.n(rn),j=n(22811),on=(0,F.forwardRef)(function(T,t){var E=(0,F.useRef)(),M=(0,F.useState)(),z=(0,H.Z)(M,2),I=z[0],K=z[1],W=(0,G.QT)("/attach/default"),B=W.data,N=(0,G.tT)("attach",function(y){return{refresh:y.refresh,cateInfo:y.cateInfo,cateData:ln().cloneDeep(y.cateData)}}),V=N.refresh,P=N.cateInfo,D=N.cateData;(0,F.useImperativeHandle)(t,function(){return{setPid:function(c){return K(c)}}});var _=function(){var y=(0,Fe.Z)(ue().mark(function c(p){var S,d,r;return ue().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return r=T!=null&&T.path?(0,x.Z)((0,x.Z)({},p),{},{pid:I!=null?I:0}):(0,x.Z)((0,x.Z)({},p),{},{id:(S=P==null?void 0:P.id)!==null&&S!==void 0?S:0,pid:(d=I!=null?I:P==null?void 0:P.pid)!==null&&d!==void 0?d:0}),C.next=3,(0,me.a1)(r).then(function(h){(h==null?void 0:h.success)&&te.default.success(h.msg)}).finally(function(){return V()});case 3:case"end":return C.stop()}},c)}));return function(p){return y.apply(this,arguments)}}(),oe=(0,F.useState)({cropRequire:!1,limitRequire:!1,astrictRequire:!1,fileExtRequire:!1,fileMimeRequire:!1}),Q=(0,H.Z)(oe,2),L=Q[0],X=Q[1];return(0,e.jsxs)(j.aN,{drawerProps:{width:520,maskClosable:!1,destroyOnClose:!0,className:"create-drawer"},title:P!=null&&P.id?"\u7F16\u8F91\u76EE\u5F55":"\u65B0\u589E\u76EE\u5F55",submitter:{searchConfig:{resetText:"\u91CD\u7F6E"},submitButtonProps:{shape:"round"},resetButtonProps:{shape:"round",type:"default",onClick:function(){var c;return(c=E.current)===null||c===void 0?void 0:c.resetFields()}}},formRef:E,autoFocusFirstInput:!0,open:T.drawerOpen,validateTrigger:["onBlur"],onOpenChange:T.handleSetDrawerOpen,onFinish:function(c){return _(c).then(function(){return!0})},initialValues:T!=null&&T.path?{path:T.path,option:0}:P,children:[(0,e.jsx)(j.Ve,{name:"path",hasFeedback:!0,label:"\u4E0A\u7EA7\u76EE\u5F55",placeholder:"\u8BF7\u9009\u62E9\u4E0A\u7EA7\u76EE\u5F55",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u4E0A\u7EA7\u9644\u4EF6\u76EE\u5F55"}],fieldProps:{showSearch:!0,changeOnSelect:!0,options:D.map(function(y){return y.id||(y.disabled=!1),y}),onChange:function(c){return K(c.at(-1))},fieldNames:{label:"name",value:"id",children:"children"}},transform:function(c){return c instanceof Array?{path:c.join("-")}:{path:c}},convertValue:function(c){var p;return c instanceof Array?c:(p=c==null?void 0:c.split("-").map(Number))!==null&&p!==void 0?p:[0]}}),(0,e.jsx)(j.V,{hasFeedback:!0,name:"name",label:"\u76EE\u5F55\u540D\u79F0",placeholder:"\u8BF7\u8F93\u5165\u76EE\u5F55\u540D\u79F0",fieldProps:{maxLength:64,showCount:!0,onBlur:function(c){var p;(T==null?void 0:T.path)&&((p=E.current)===null||p===void 0||p.setFieldValue("ename",(0,Ie.Qh)(c.target.value).replace(/\s+/g,"")))}},rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u76EE\u5F55\u540D\u79F0"},{type:"string",pattern:/^[\u4e00-\u9fa5\w]+$/,message:"\u76EE\u5F55\u540D\u79F0\u4E0D\u5F97\u5305\u542B\u7279\u6B8A\u7B26\u53F7"}]}),(0,e.jsx)(j.V,{hasFeedback:!0,name:"ename",label:"\u76EE\u5F55\u522B\u540D",tooltip:"\u7CFB\u7EDF\u81EA\u52A8\u751F\u6210",placeholder:"\u8BF7\u8F93\u5165\u76EE\u5F55\u522B\u540D",fieldProps:{maxLength:64,showCount:!0},rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u76EE\u5F55\u522B\u540D"},{type:"string",pattern:/^\w+$/,message:"\u76EE\u5F55\u522B\u540D\u53EA\u80FD\u662F\u5B57\u6BCD\u3001\u6570\u5B57\u548C\u4E0B\u5212\u7EBF\u7684\u7EC4\u5408"}]}),(0,e.jsx)(j.$O.Group,{name:"option",label:"\u4E0A\u4F20\u914D\u7F6E",options:[{label:"\u9ED8\u8BA4\u914D\u7F6E",value:0},{label:"\u81EA\u5B9A\u4E49\u914D\u7F6E",value:1}]}),(0,e.jsx)(j.ie,{name:["option"],children:function(c){var p=c.option;if(p)return[(0,e.jsxs)(j.UW,{size:3,label:"\u914D\u7F6E\u9009\u9879",children:[(0,e.jsx)(j.V2,{name:"limit",fieldProps:{onChange:function(d){var r;X(function(m){return(0,x.Z)((0,x.Z)({},m),{},{limitRequire:d.target.checked})}),!d.target.checked&&((r=E.current)===null||r===void 0||r.setFieldValue("size",void 0))}},children:"\u6587\u4EF6\u5927\u5C0F"}),(0,e.jsx)(j.V2,{name:"astrict",fieldProps:{onChange:function(d){var r;X(function(m){return(0,x.Z)((0,x.Z)({},m),{},{astrictRequire:d.target.checked})}),!d.target.checked&&((r=E.current)===null||r===void 0||r.setFieldValue("astricts",void 0))}},children:"\u9650\u5236\u5BBD\u9AD8"}),(0,e.jsx)(j.V2,{name:"crop",fieldProps:{onChange:function(d){var r;X(function(m){return(0,x.Z)((0,x.Z)({},m),{},{cropRequire:d.target.checked})}),!d.target.checked&&((r=E.current)===null||r===void 0||r.setFieldValue("aspects",void 0))}},children:"\u542F\u7528\u88C1\u526A"}),(0,e.jsx)(j.V2,{name:"suff",fieldProps:{onChange:function(d){var r;X(function(m){return(0,x.Z)((0,x.Z)({},m),{},{fileExtRequire:d.target.checked})}),!d.target.checked&&((r=E.current)===null||r===void 0||r.setFieldValue("fileExt",void 0))}},children:"\u6587\u4EF6\u540E\u7F00"}),(0,e.jsx)(j.V2,{name:"mime",fieldProps:{onChange:function(d){var r;X(function(m){return(0,x.Z)((0,x.Z)({},m),{},{fileMimeRequire:d.target.checked})}),!d.target.checked&&((r=E.current)===null||r===void 0||r.setFieldValue("fileMime",void 0))}},children:"\u6587\u4EF6\u7C7B\u578B"})]},"options"),(0,e.jsx)(j.ie,{name:["limit"],children:function(d){var r=d.limit;if(r)return(0,e.jsx)(j.k_,{max:512,width:150,name:"size",label:"\u6587\u4EF6\u5927\u5C0F",tooltip:"\u4E0A\u4F20\u6587\u4EF6\u7684\u5927\u5C0F",fieldProps:{precision:0,addonAfter:"MB"},rules:[{required:L.limitRequire,message:"\u8BF7\u8BBE\u7F6E\u6587\u4EF6\u5927\u5C0F\u503C"}]},"size")}},"limit"),(0,e.jsx)(j.ie,{name:["astrict"],children:function(d){var r=d.astrict;if(r)return[(0,e.jsx)(j.e9,{name:"astricts",label:"\u9650\u5236\u5BBD\u9AD8",tooltip:"\u9650\u5236\u56FE\u50CF\u6700\u5C0F\u5BBD\u9AD8",fieldProps:{precision:0,addonAfter:"PX",onBlur:function(C){return C.stopPropagation()}},rules:[function(){return{validator:function(C,h){return h instanceof Array&&h.filter(function($){return typeof $=="number"}).length==2?Promise.resolve():Promise.reject("\u8BF7\u5B8C\u5584\u56FE\u50CF\u5BBD\u9AD8\u53C2\u6570")}}}]},"astricts")]}},"astrict"),(0,e.jsx)(j.ie,{name:["crop"],children:function(d){var r=d.crop;if(r)return[(0,e.jsx)(j.e9,{name:"aspects",label:"\u88C1\u526A\u6BD4\u4F8B",tooltip:"\u9700\u4E3A\u6B63\u6574\u6570",fieldProps:{precision:0,onBlur:function(C){return C.stopPropagation()}},rules:[function(){return{validator:function(C,h){return h instanceof Array&&h.filter(function($){return typeof $=="number"}).length==2?Promise.resolve():Promise.reject("\u8BF7\u5B8C\u5584\u88C1\u526A\u6BD4\u4F8B\u53C2\u6570")}}}]},"aspects")]}},"crop"),(0,e.jsx)(j.ie,{name:["suff"],children:function(d){var r=d.suff;if(r){var m;return[(0,e.jsx)(j._I,{name:"fileExt",label:"\u6587\u4EF6\u540E\u7F00",tooltip:"\u9650\u5236\u4E0A\u4F20\u7684\u6587\u4EF6\u540E\u7F00",fieldProps:{mode:"tags",maxTagCount:13,options:B==null||(m=B.list.fileExt)===null||m===void 0?void 0:m.map(function(C){return{label:C,value:C}})},rules:[{required:L.fileExtRequire,message:"\u8BF7\u8BBE\u7F6E\u6587\u4EF6\u540E\u7F00"}]},"fileExt")]}else return}},"suff"),(0,e.jsx)(j.ie,{name:["mime"],children:function(d){var r=d.mime;if(r){var m;return[(0,e.jsx)(j._I,{name:"fileMime",label:"\u6587\u4EF6\u7C7B\u578B",tooltip:"\u9650\u5236\u4E0A\u4F20\u7684\u6587\u4EF6\u7C7B\u578B",fieldProps:{mode:"tags",maxTagCount:10,options:B==null||(m=B.list.fileMime)===null||m===void 0?void 0:m.map(function(C){return{label:C,value:C}})},rules:[{required:L.fileMimeRequire,message:"\u8BF7\u8BBE\u7F6E\u6587\u4EF6\u7C7B\u578B"}]},"fileMime")]}else return}},"mime")]}})]})}),sn=n(44545),dn=function(){var t=un.Z.Search,E=Me.Z.Text,M=(0,F.useState)(),z=(0,H.Z)(M,2),I=z[0],K=z[1],W=(0,F.useRef)(),B=(0,F.useState)(""),N=(0,H.Z)(B,2),V=N[0],P=N[1],D=(0,F.useState)(!1),_=(0,H.Z)(D,2),oe=_[0],Q=_[1],L=(0,F.useState)(!0),X=(0,H.Z)(L,2),y=X[0],c=X[1],p=(0,G.tT)("attach",function(s){return{cateId:s.cateId,loading:s.loading,refresh:s.refresh,getInfo:s.getInfo,isModal:s.isModal,cateData:s.cateData,setCateId:s.setCateId,setCateInfo:s.setCateInfo,expandedKeys:s.expandedKeys,setPagination:s.setPagination,setExpandedKeys:s.setExpandedKeys}}),S=p.cateId,d=p.getInfo,r=p.refresh,m=p.loading,C=p.isModal,h=p.cateData,$=p.setCateId,O=p.setCateInfo,se=p.expandedKeys,ce=p.setPagination,U=p.setExpandedKeys,ge=function s(a,l){for(var u,o=0;o<l.length;o++){var v=l[o];v.children&&(v.children.some(function(R){return R.id===a})?u=v.id:s(a,v.children)&&(u=s(a,v.children)))}return u},fe=function(a,l){var u;switch(a.key){case"update":a.domEvent.stopPropagation(),d({id:l}).then(function(){(0,Ie.pQ)().then(function(){return Q(!0)})});break;case"create":a.domEvent.stopPropagation(),(u=W.current)===null||u===void 0||u.setPid(l),l?d({id:l}).then(function(o){K(o==null?void 0:o.info.path.split("-").map(Number).concat(l).filter(function(v){return v}))}).finally(function(){return Q(!0)}):(K([0]),Q(!0),O(void 0));break;default:a.domEvent.stopPropagation()}},w=function(){var s=(0,Fe.Z)(ue().mark(function a(l){return ue().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,(0,me.Od)({id:l}).then(function(v){return(v==null?void 0:v.success)&&te.default.success(v.msg),v==null?void 0:v.success}).finally(function(){return r()});case 2:return o.abrupt("return",o.sent);case 3:case"end":return o.stop()}},a)}));return function(l){return s.apply(this,arguments)}}(),pe=function(a){var l=[{key:"create",label:"\u65B0\u589E\u76EE\u5F55"},{key:"update",label:"\u7F16\u8F91\u76EE\u5F55"},{key:"delete",label:(0,e.jsx)(an.Z,{title:"\u786E\u8BA4\u5220\u9664\u8BE5\u76EE\u5F55?",onConfirm:function(){return w(a)},children:(0,e.jsx)(E,{children:"\u5220\u9664\u76EE\u5F55"})})}];return(0,e.jsx)(tn.Z,{onClick:function(o){return fe(o,a)},items:a!=0?l:l.splice(0,1)})},xe=function(a){return(0,e.jsxs)("div",{className:"customRender",children:[(0,e.jsx)(E,{children:a.title}),(0,e.jsx)(nn.Z,{trigger:["click"],placement:"bottomRight",overlay:function(){return pe(a.key)},getPopupContainer:function(u){return u.parentNode},children:(0,e.jsx)(E,{onClick:function(u){return u==null?void 0:u.stopPropagation()},children:(0,e.jsx)(sn.Z,{className:"overlayDropDown"})})})]})},J=[],ve=function s(a){for(var l=0;l<a.length;l++){var u=a[l],o=u.id,v=u.name;J.push({key:o,title:v}),u.children&&s(u.children)}};ve(h);var b=function(a){U(a),c(!1)},Z=function(a){var l=a.target.value,u=J.map(function(o){return l&&o.title.indexOf(l)>-1?ge(o.key,h):null}).filter(function(o,v,R){return o&&R.indexOf(o)===v});P(l),c(!0),U(u)},A=(0,F.useMemo)(function(){var s=function a(l){return l.map(function(u){var o=u.name,v=o.indexOf(V),R=o.substring(0,v),i=o.slice(v+V.length),f=v>-1?(0,e.jsxs)("span",{children:[R,(0,e.jsx)("span",{className:"site-tree-search-value",children:V}),i]}):(0,e.jsx)("span",{children:o});return u.children?{title:f,key:u.id,children:a(u.children)}:{title:f,key:u.id}})};return s(h)},[h,V]);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(t,{allowClear:!0,onChange:Z,className:"treeSearch",placeholder:"\u8BF7\u8F93\u5165\u5206\u7C7B\u540D\u79F0"}),(0,e.jsx)(Ce.Z,{spinning:m,tip:"Loading...",children:(0,e.jsx)(en.Z,{treeData:A,onExpand:b,selectedKeys:S,defaultSelectedKeys:[0],titleRender:xe,expandedKeys:se,height:C?490:void 0,autoExpandParent:y,rootClassName:C?"modalTree":"normalTree",onSelect:function(a,l){var u=l.selected;u&&$(a),u&&!a.at(0)&&O(void 0),u&&a.at(0)&&d({id:a.at(0)}),u&&ce(function(o){return{current:1,pageSize:o.pageSize}})}})}),(0,e.jsx)(on,{path:I,ref:W,drawerOpen:oe,handleSetDrawerOpen:function(a){Q(a),!a&&K(void 0)}})]})},cn=function(t){var E,M,z,I=(E=t==null?void 0:t.gutter)!==null&&E!==void 0?E:[32,32],K=(M=t==null?void 0:t.previewSpan)!==null&&M!==void 0?M:20,W=(z=t==null?void 0:t.directorySpan)!==null&&z!==void 0?z:4,B=(0,G.tT)("attach",function(V){return{run:V.run}}),N=B.run;return(0,F.useEffect)(function(){N({pid:0})},[N]),(0,e.jsxs)(de.Z,{gutter:I,style:{padding:"16px"},children:[(0,e.jsx)(ee.Z,{span:W,children:(0,e.jsx)(dn,{})}),(0,e.jsx)(ee.Z,{span:K,children:(0,e.jsx)(_e,{})})]})}},21940:function(we,Pe,n){"use strict";n.d(Pe,{e:function(){return Se}});var We=n(12968),de=n(40610),Oe=n(2824),ee=n(75860),G=n(67294),Ee=n(85893),Se=(0,G.forwardRef)(function(le,Ce){var ye,De=(ye=le==null?void 0:le.curIdx)!==null&&ye!==void 0?ye:0,Ae=(0,G.useState)(!1),he=(0,Oe.Z)(Ae,2),Re=he[0],ne=he[1];return(0,G.useImperativeHandle)(Ce,function(){return{imagePreview:function(Y){return ne(Y)}}}),(0,Ee.jsx)("div",{style:{display:"none"},children:(0,Ee.jsx)(de.Z.PreviewGroup,{preview:{visible:Re,current:De,onVisibleChange:function(Y){return ne(Y)}},children:le==null?void 0:le.imgList.map(function(q){var Y,je;return(0,Ee.jsx)(de.Z,{src:(je=q==null?void 0:q.url)!==null&&je!==void 0?je:q.static_path},(Y=q==null?void 0:q.id)!==null&&Y!==void 0?Y:(0,ee.O1)(4))})})})})}}]);
